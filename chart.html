<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Full History</title>
    
    <style></style>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
  </head>

  <body class="">

    <nav class="nav nav-pills flex-column flex-sm-row container" style="padding-top: 10px; padding-bottom: 20px;">
      <a class="flex-sm-fill text-sm-center nav-link" href="index.html">HOME</a>
      <a class="flex-sm-fill text-sm-center nav-link active" aria-current="page" href="chart.html">Full History</a>
      <a class="flex-sm-fill text-sm-center nav-link" href="download data.html">Download Live Data</a>
      <a class="flex-sm-fill text-sm-center nav-link" href="hardware.html">Hardware Description</a>
      <a class="flex-sm-fill text-sm-center nav-link" href="about_us.html">About Us</a>
  </nav>
    <br>

    <h3 class="container" style="padding-bottom: 20px;">Collected Data from our Power Consumption Monitoring Socket: </h3>
    <hr class="container">
    <!--Main layout-->
    <main>
      <div class="container">
        <!-- Table -->
        <table class="table">
          <thead id="table-head"></thead>
          <tbody id="table-body"></tbody>
        </table>
        <!-- Table -->
      </div>
    </main>

  </body>

  <!-- Google API -->
  <script src="https://apis.google.com/js/api.js"></script>
  <!-- easyData -->
  <script type="text/javascript" src="js/easyData-google-sheets.js"></script>

  <!-- easyData - Creating table -->
  <script>
    {
      {
        // Your API KEY
        const API_KEY = "AIzaSyBqRnfT-UUIkqwUE350CuJrAX9gf2mCXX8";

        function displayResult2(response) {
          let tableHead = "";
          let tableBody = "";

          response.result.values.forEach((row, index) => {
            if (index === 0) {
              tableHead += "<tr>";
              row.forEach((val) => (tableHead += "<th>" + val + "</th>"));
              tableHead += "</tr>";
            } else {
              tableBody += "<tr>";
              row.forEach((val) => (tableBody += "<td>" + val + "</td>"));
              tableBody += "</tr>";
            }
          });

          document.getElementById("table-head").innerHTML = tableHead;
          document.getElementById("table-body").innerHTML = tableBody;
        }

        function loadData() {
          //https://docs.google.com/spreadsheets/d/12GAxTVI8JvMG_B71rtJl_eSdNZhgzzD35s_SWKSugIo/edit#gid=0          // Spreadsheet ID
          const spreadsheetId = "12GAxTVI8JvMG_B71rtJl_eSdNZhgzzD35s_SWKSugIo";
          const range = "A:Z";
          getPublicValues({ spreadsheetId, range }, displayResult2);
        }

        window.addEventListener("load", (e) => {
          initOAuthClient({ apiKey: API_KEY });
        });

        document.addEventListener("gapi-loaded", (e) => {
          loadData();
        });
      }
    }
  </script>
</html>
